<!DOCTYPE html>
<html lang="en">
  <head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no">
    <title>TextBtn Example - Tiny UI Components</title>
    <style>
    * { padding: 0; margin: 0; }
    html,body { margin: 0; padding: 0; overflow: hidden; width: 100%; height: 100%; }
    canvas { 
      touch-action: none; 
      -webkit-tap-highlight-color: rgba(0,0,0,0);
      user-select: none;
      width: 100%; height: 100%; 
    }
    #info {
      position: fixed;
      bottom: 10px; left: 10px;
      background: rgba(0, 0, 0, 0.7);
      color: white;
      padding: 10px;
      font-family: monospace;
      font-size: 12px;
      border-radius: 4px;
      pointer-events: none;
      z-index: 1000;
    }
    </style>
  </head>
  <body>
    <div id="info">
      <div>TextBtn (DPR: <span id="dpr">1</span>x)</div>
      <div>单列布局</div>
    </div>
    <canvas id="game"></canvas>
    <script src="/core/dist/tiny-ui-core.js"></script>
    <script src="/components/dist/tiny-ui-components.js"></script>
    <script>
    const canvas = document.getElementById('game');
    const tinyUI = new TinyUI(canvas);
    const { TextBtn } = TinyUIComponents;
    const { adjustTo } = TinyUIComponents.utils;

    const dpr = window.devicePixelRatio || 1;
    document.getElementById('dpr').textContent = dpr.toFixed(1);
    const scale = (val) => val * Math.min(dpr, 2);

    // 布局参数
    const colWidth = scale(300);       // 列宽
    const rowHeight = scale(80);       // 每行高度
    const startY = scale(70);          // 起始 Y

    // 背景
    const bg = tinyUI.createGraphics();
    bg.anchorX = 0;
    bg.anchorY = 0;
    bg.drawRect(0, 0, tinyUI.stageWidth, tinyUI.stageHeight, '#f8fafc');
    tinyUI.root.addChild(bg);

    // 标题
    const title = tinyUI.createText('TextBtn - 单列布局');
    title.color = '#333333';
    title.fontSize = scale(28);
    title.updateTexture();
    tinyUI.root.addChild(title);
    adjustTo(tinyUI.root, true)(title, { h: 'center', v: 'top' }, { y: scale(20) });

    // ========== 容器 ==========
    const mainContainer = tinyUI.createContainer('MainContainer');
    mainContainer.setSize({ width: colWidth, height: rowHeight * 10 });
    tinyUI.root.addChild(mainContainer);
    adjustTo(tinyUI.root, true)(mainContainer, { h: 'center', v: 'top' }, { y: startY });

    // 容器背景（调试用）
    const containerBg = tinyUI.createGraphics('ContainerBg');
    containerBg.alpha = 0.1;
    containerBg.anchorX = 0;
    containerBg.anchorY = 0;
    containerBg.drawRect(0, 0, colWidth, rowHeight * 10, '#3b82f6');
    mainContainer.addChild(containerBg);

    // 辅助函数：在容器内创建一行
    function createSection(container, rowIndex, labelText, createButtonsFn) {
      const y = rowIndex * rowHeight;

      // Label
      const label = tinyUI.createText(labelText);
      label.color = '#666666';
      label.fontSize = scale(14);
      label.updateTexture();
      container.addChild(label);
      adjustTo(container, true)(label, { h: 'left', v: 'top' }, { x: scale(10), y: y + scale(5) });

      // Buttons 容器
      const btnContainer = tinyUI.createContainer('BtnRow');
      btnContainer.setSize({ width: colWidth - scale(20), height: scale(45) });
      container.addChild(btnContainer);
      adjustTo(container, true)(btnContainer, { h: 'left', v: 'top' }, { x: scale(10), y: y + scale(28) });

      createButtonsFn(btnContainer);
    }

    // ========== 第一部分 ==========
    
    // 1: 基础
    createSection(mainContainer, 0, '1. 基础 Basic', (container) => {
      const { container: btn } = TextBtn({
        app: tinyUI,
        text: 'Button',
        width: scale(120),
        height: scale(40),
        fontSize: scale(16),
        onClick: () => console.log('Basic clicked')
      });
      container.addChild(btn);
      adjustTo(container, true)(btn, { h: 'left', v: 'top' });
    });

    // 2: 颜色
    createSection(mainContainer, 1, '2. 颜色 Colors', (container) => {
      const { container: btn1 } = TextBtn({
        app: tinyUI,
        text: 'Green',
        width: scale(80),
        height: scale(40),
        fontSize: scale(14),
        bgColor: '#10b981',
        onClick: () => console.log('Green clicked')
      });
      container.addChild(btn1);
      adjustTo(container, true)(btn1, { h: 'left', v: 'top' });

      const { container: btn2 } = TextBtn({
        app: tinyUI,
        text: 'Red',
        width: scale(80),
        height: scale(40),
        fontSize: scale(14),
        bgColor: '#ef4444',
        onClick: () => console.log('Red clicked')
      });
      container.addChild(btn2);
      adjustTo(container, true)(btn2, { h: 'left', v: 'top' }, { x: scale(90) });
    });

    // 3: 圆角
    createSection(mainContainer, 2, '3. 圆角 Radius', (container) => {
      const { container: btn1 } = TextBtn({
        app: tinyUI,
        text: 'R8',
        width: scale(60),
        height: scale(40),
        fontSize: scale(14),
        radius: 8,
        bgColor: '#8b5cf6',
        onClick: () => console.log('R8 clicked')
      });
      container.addChild(btn1);
      adjustTo(container, true)(btn1, { h: 'left', v: 'top' });

      const { container: btn2 } = TextBtn({
        app: tinyUI,
        text: 'R16',
        width: scale(60),
        height: scale(40),
        fontSize: scale(14),
        radius: 16,
        bgColor: '#8b5cf6',
        onClick: () => console.log('R16 clicked')
      });
      container.addChild(btn2);
      adjustTo(container, true)(btn2, { h: 'left', v: 'top' }, { x: scale(70) });

      const { container: btn3 } = TextBtn({
        app: tinyUI,
        text: 'Pill',
        width: scale(60),
        height: scale(40),
        fontSize: scale(14),
        radius: scale(20),
        bgColor: '#8b5cf6',
        onClick: () => console.log('Pill clicked')
      });
      container.addChild(btn3);
      adjustTo(container, true)(btn3, { h: 'left', v: 'top' }, { x: scale(140) });
    });

    // 4: 按压效果
    createSection(mainContainer, 3, '4. 按压 Press', (container) => {
      const { container: btn1 } = TextBtn({
        app: tinyUI,
        text: 'Off',
        width: scale(80),
        height: scale(40),
        fontSize: scale(14),
        pressEffect: false,
        bgColor: '#64748b',
        onClick: () => console.log('Off clicked')
      });
      container.addChild(btn1);
      adjustTo(container, true)(btn1, { h: 'left', v: 'top' });

      const { container: btn2 } = TextBtn({
        app: tinyUI,
        text: 'On',
        width: scale(80),
        height: scale(40),
        fontSize: scale(14),
        pressEffect: true,
        bgColor: '#64748b',
        onClick: () => console.log('On clicked')
      });
      container.addChild(btn2);
      adjustTo(container, true)(btn2, { h: 'left', v: 'top' }, { x: scale(90) });
    });

    // 5: 字号
    createSection(mainContainer, 4, '5. 字号 Size', (container) => {
      const { container: btn1 } = TextBtn({
        app: tinyUI,
        text: '14px',
        width: scale(70),
        height: scale(40),
        fontSize: scale(14),
        bgColor: '#0ea5e9',
        onClick: () => console.log('14px clicked')
      });
      container.addChild(btn1);
      adjustTo(container, true)(btn1, { h: 'left', v: 'top' });

      const { container: btn2 } = TextBtn({
        app: tinyUI,
        text: '20px',
        width: scale(70),
        height: scale(40),
        fontSize: scale(20),
        bgColor: '#0ea5e9',
        onClick: () => console.log('20px clicked')
      });
      container.addChild(btn2);
      adjustTo(container, true)(btn2, { h: 'left', v: 'top' }, { x: scale(80) });
    });

    // ========== 第二部分（原红列）==========
    
    // 6: 自适应
    createSection(mainContainer, 5, '6. 自适应 Responsive', (container) => {
      const { container: btn } = TextBtn({
        app: tinyUI,
        text: '自适应宽度',
        responsive: true,
        bgColor: '#6366f1',
        fontSize: scale(14),
        onClick: () => console.log('Responsive clicked')
      });
      container.addChild(btn);
      adjustTo(container, true)(btn, { h: 'left', v: 'top' });
    });

    // 7: 动态
    createSection(mainContainer, 6, '7. 动态 Dynamic', (container) => {
      let state = 0;
      const colors = ['#ef4444', '#f59e0b', '#10b981', '#3b82f6'];
      const labels = ['Red', 'Orange', 'Green', 'Blue'];

      const { container: btn, setBgColor } = TextBtn({
        app: tinyUI,
        text: 'Click Me',
        width: scale(140),
        height: scale(40),
        fontSize: scale(16),
        bgColor: colors[0],
        onClick: () => {
          state = (state + 1) % colors.length;
          setBgColor(colors[state]);
          console.log(`Changed to ${labels[state]}`);
        }
      });
      container.addChild(btn);
      adjustTo(container, true)(btn, { h: 'left', v: 'top' });
    });

    // 8: 圆角切换
    createSection(mainContainer, 7, '8. 圆角切换', (container) => {
      let rState = 0;
      const radii = [0, 8, 16, scale(20)];
      const rLabels = ['□', 'R8', 'R16', '●'];

      const { container: btn, setRadius } = TextBtn({
        app: tinyUI,
        text: '□',
        width: scale(140),
        height: scale(40),
        fontSize: scale(16),
        radius: 0,
        bgColor: '#06b6d4',
        onClick: () => {
          rState = (rState + 1) % radii.length;
          setRadius(radii[rState]);
          const txt = btn.children[1];
          txt.text = rLabels[rState];
          txt.updateTexture();
          console.log(`Radius: ${radii[rState]}`);
        }
      });
      container.addChild(btn);
      adjustTo(container, true)(btn, { h: 'left', v: 'top' });
    });

    // 9: 透明
    createSection(mainContainer, 8, '9. 透明 Transparent', (container) => {
      const { container: btn1 } = TextBtn({
        app: tinyUI,
        text: '透明效果',
        width: scale(90),
        height: scale(40),
        fontSize: scale(14),
        pressEffect: true,
        bgColor: 'transparent',
        textColor: '#64748b',
        onClick: () => console.log('透明 clicked')
      });
      container.addChild(btn1);
      adjustTo(container, true)(btn1, { h: 'left', v: 'top' });

      const { container: btn2 } = TextBtn({
        app: tinyUI,
        text: '无效果',
        width: scale(80),
        height: scale(40),
        fontSize: scale(14),
        pressEffect: false,
        bgColor: 'transparent',
        textColor: '#64748b',
        onClick: () => console.log('无效果 clicked')
      });
      container.addChild(btn2);
      adjustTo(container, true)(btn2, { h: 'left', v: 'top' }, { x: scale(100) });
    });

    // 10: 字重
    createSection(mainContainer, 9, '10. 字重 Font Weight', (container) => {
      const { container: btn1 } = TextBtn({
        app: tinyUI,
        text: 'Normal',
        width: scale(80),
        height: scale(40),
        fontSize: scale(14),
        fontWeight: 'normal',
        bgColor: '#0ea5e9',
        onClick: () => console.log('Normal clicked')
      });
      container.addChild(btn1);
      adjustTo(container, true)(btn1, { h: 'left', v: 'top' });

      const { container: btn2 } = TextBtn({
        app: tinyUI,
        text: 'Bold',
        width: scale(80),
        height: scale(40),
        fontSize: scale(14),
        fontWeight: 'bold',
        bgColor: '#0ea5e9',
        onClick: () => console.log('Bold clicked')
      });
      container.addChild(btn2);
      adjustTo(container, true)(btn2, { h: 'left', v: 'top' }, { x: scale(90) });
    });

    // 底部说明
    const hint = tinyUI.createText('检查文本垂直居中 | 长按测试按压效果 | 点击切换测试动态功能');
    hint.color = '#999999';
    hint.fontSize = scale(12);
    hint.updateTexture();
    tinyUI.root.addChild(hint);
    adjustTo(tinyUI.root, true)(hint, { h: 'center', v: 'bottom' }, { y: -scale(15) });

    // 渲染循环
    function renderLoop() {
      tinyUI.render();
      requestAnimationFrame(renderLoop);
    }
    renderLoop();
    </script>
  </body>
</html>
